---
title: "Final Project"
author: "julia"
date: "2022/5/24"
output: html_document
---

```{r}
library(tidyverse)
library(readxl)
library(lubridate)
library(ggplot2)
library(stringr)
```

```{r}
finalProj <- list()
finalProj$BureauEnergy$source <- "https://www.moeaboe.gov.tw/ECW/populace/content/SubMenu.aspx?menu_id=3010"

#台灣能源總消費量
url <- "https://github.com/hereisjulia/R_Visualization/blob/main/Tasks/Final%20Project/DomesticEnergyConsumption.xlsx?raw=true"
destfile <- "DomesticEnergyConsumption.xlsx"
curl::curl_download(url, destfile)
finalProj$BureauEnergy$data$Dom_Energy_Consumption <- read_excel(destfile, skip = 1)

#台灣進口能源國家比例
url <- "https://github.com/hereisjulia/R_Visualization/blob/main/Tasks/Final%20Project/ImportEnergySource.xlsx?raw=true"
destfile <- "ImportEnergySource.xlsx"
curl::curl_download(url, destfile)
finalProj$BureauEnergy$data$Imp_EnergySource <- read_excel(destfile, skip = 1)

#台灣對進口能源依賴比率
url <- "https://github.com/hereisjulia/R_Visualization/blob/main/Tasks/Final%20Project/ImportEnergyRelience.xlsx?raw=true"
destfile <- "ImportEnergyRelience.xlsx"
curl::curl_download(url, destfile)
finalProj$BureauEnergy$data$Imp_EnergyRelience <- read_excel(destfile, skip = 1)

View(finalProj$BureauEnergy$data$Imp_EnergyRelience)
```

#圖一
/內容包含：台灣能源總量+進口量+依賴進口量
/data格式：2019年1月到2022年3月的月資料
/aes 設計：呈現總能源量>凸顯對進口能源依賴>顯示進口能源類別
---用area+線圖呈現

##台灣能源總量
但現在我們的資料形式是wide form, 先把它改成long.
```{r}
pivot_longer(
  finalProj$BureauEnergy$data$Dom_Energy_Consumption,
  cols = -c(1),
  names_to = "month",
  values_to = "Energy_Consump"
) -> finalProj$BureauEnergy$data$Dom_Energy_Consumption

paste(finalProj$BureauEnergy$data$Dom_Energy_Consumption$month, "-01") -> finalProj$BureauEnergy$data$Dom_Energy_Consumption$month
lubridate::ymd(finalProj$BureauEnergy$data$Dom_Energy_Consumption$month) -> finalProj$BureauEnergy$data$Dom_Energy_Consumption$month

```
##進口量
```{r}
pivot_longer(
  finalProj$BureauEnergy$data$Imp_EnergySource,
  cols = -c(1:2),
  names_to = "month",
  values_to = "能源當量"
) -> finalProj$BureauEnergy$data$Imp_EnergySource
```

##進口能源依賴
```{r}
pivot_longer(
  finalProj$BureauEnergy$data$Imp_EnergyRelience,
  cols = -c(1),
  names_to = month,
  values_to = relience(%)
) -> finalProj$BureauEnergy$data$Imp_EnergyRelience
```

```{r}
finalProj$BureauEnergy$data$Dom_Energy_Consumption$month|>class()
finalProj$BureauEnergy$data$Dom_Energy_Consumption$Energy_Consump|>class()


ggplot()+
  geom_area(
    data = finalProj$BureauEnergy$data$Dom_Energy_Consumption,
    mapping = aes(
      x=month,
      y=Energy_Consump
    )
  )#+
  geom_area(
    data = finalProj$BureauEnergy$data$Imp_EnergySource, #這邊應該還要再處理一下，資料太雜(用能源分類)
    mapping = aes(
      x=,
      y=能源當量
    )
  )
  geom_line(
    data = finalProj$BureauEnergy$data$Imp_EnergyRelience,
    mapping = aes(
      x= seq(1:39),
      y= `relience(%)`
    )
  )
```











